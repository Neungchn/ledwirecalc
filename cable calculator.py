import math

def calculate_cable_size():
    """
    ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≠ LED
    """
    print("--- ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≠ LED ---")
    print("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:")

    # 1. ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏à‡∏≠
    while True:
        try:
            width = float(input("‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ (‡πÄ‡∏°‡∏ï‡∏£): "))
            height = float(input("‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ (‡πÄ‡∏°‡∏ï‡∏£): "))
            area = width * height
            print(f"‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏à‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {area:.2f} ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏ï‡∏£")
            break
        except ValueError:
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")

    # 2. ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ï‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏ï‡∏£
    while True:
        try:
            power_per_sqm = float(input("‡∏õ‡πâ‡∏≠‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠ ‡∏ï‡∏£.‡∏°. (‡∏ß‡∏±‡∏ï‡∏ï‡πå/‡∏ï‡∏£.‡∏°.): "))
            break
        except ValueError:
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")

    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏£‡∏ß‡∏°
    power_watt = area * power_per_sqm
    print(f"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏à‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {power_watt:.2f} ‡∏ß‡∏±‡∏ï‡∏ï‡πå")

    # 3. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ü‡∏™ (Phase)
    while True:
        try:
            phase = int(input("‡∏õ‡πâ‡∏≠‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ü‡∏™ (1 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ü‡∏™‡πÄ‡∏î‡∏µ‡∏¢‡∏ß, 3 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏°‡πÄ‡∏ü‡∏™): "))
            if phase in [1, 3]:
                break
            else:
                print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô 1 ‡∏´‡∏£‡∏∑‡∏≠ 3 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô")
        except ValueError:
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")

    # 4. ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á (Installation Type)
    print("\n‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:")
    print("1: ‡πÄ‡∏î‡∏¥‡∏ô‡∏•‡∏≠‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏® / ‡πÉ‡∏ô‡∏ó‡πà‡∏≠‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏≤‡∏¢ (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£)")
    print("2: ‡πÄ‡∏î‡∏¥‡∏ô‡∏•‡∏≠‡∏¢ / ‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠ (‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ / ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô)")
    print("3: ‡πÄ‡∏î‡∏¥‡∏ô‡∏ù‡∏±‡∏á‡∏î‡∏¥‡∏ô / ‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô")
    while True:
        try:
            installation_type = int(input("‡∏õ‡πâ‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á (1-3): "))
            if installation_type in [1, 2, 3]:
                break
            else:
                print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô 1, 2 ‡∏´‡∏£‡∏∑‡∏≠ 3 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô")
        except ValueError:
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")

    # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà
    pf = 0.95  # Power Factor
    voltage = 220 if phase == 1 else 380  # ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤

    # 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (Amps)
    if phase == 1:
        current = power_watt / (voltage * pf)
    else:
        current = power_watt / (math.sqrt(3) * voltage * pf)

    print(f"\n‚úÖ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô:")
    print(f"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏£‡∏ß‡∏°: {power_watt:.2f} ‡∏ß‡∏±‡∏ï‡∏ï‡πå")
    print(f"‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤: {voltage} ‡πÇ‡∏ß‡∏•‡∏ï‡πå")
    print(f"‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ: {current:.2f} ‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå")

    # 2. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÅ‡∏•‡∏∞‡∏ä‡∏ô‡∏¥‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
    derating_factor = 1.0
    cable_type_name = "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"
    if installation_type == 1:
        derating_factor = 0.8  # ‡πÄ‡∏ú‡∏∑‡πà‡∏≠ 20% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠
        cable_type_name = "**THW** (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ, ‡πÅ‡∏Å‡∏ô‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß, ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠)"
        print("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ‡πÄ‡∏î‡∏¥‡∏ô‡∏•‡∏≠‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏® / ‡πÉ‡∏ô‡∏ó‡πà‡∏≠‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏≤‡∏¢")
    elif installation_type == 2:
        derating_factor = 0.9  # ‡πÄ‡∏ú‡∏∑‡πà‡∏≠ 10% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å
        cable_type_name = "**VCT** (‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏™‡∏π‡∏á, ‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô, ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£)"
        print("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ‡πÄ‡∏î‡∏¥‡∏ô‡∏•‡∏≠‡∏¢ / ‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠ (‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£)")
    elif installation_type == 3:
        derating_factor = 1.0  # ‡∏Ñ‡πà‡∏≤‡∏ó‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏±‡∏á‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
        cable_type_name = "**NYY** (‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô, ‡∏°‡∏µ‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏∏‡πâ‡∏° 2 ‡∏ä‡∏±‡πâ‡∏ô, ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏±‡∏á‡∏î‡∏¥‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á)"
        print("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ‡πÄ‡∏î‡∏¥‡∏ô‡∏ù‡∏±‡∏á‡∏î‡∏¥‡∏ô / ‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô")

    required_current = current / derating_factor
    print(f"‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏∑‡πà‡∏≠: {required_current:.2f} ‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå")

    # ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü (‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏°‡∏≠‡∏Å. 11-2553)
    cable_table = {
        1.5: 18, 2.5: 24, 4: 32, 6: 42, 10: 57, 16: 76,
        25: 101, 35: 125, 50: 155, 70: 190, 95: 230,
        120: 265, 150: 305, 185: 350, 240: 410, 300: 475
    }

    # 3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
    suitable_cable_size = None
    cable_ampacity = 0
    for size, ampacity in sorted(cable_table.items()):
        if ampacity >= required_current:
            suitable_cable_size = size
            cable_ampacity = ampacity
            break

    # 4. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏á‡∏à‡∏£ (Circuit) ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
    breaker_rating = 0
    num_circuits = 1
    if suitable_cable_size:
        breaker_rating = math.floor(cable_ampacity * 0.8) # 80% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏≤‡∏¢
        if current > breaker_rating:
            num_circuits = math.ceil(current / breaker_rating)
        
    else:
        num_circuits = 1

    # 5. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    print("\n--- ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ---")
    if suitable_cable_size:
        print(f"üîπ ‡∏ä‡∏ô‡∏¥‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: {cable_type_name}")
        print(f"üîπ ‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: **{suitable_cable_size} ‡∏ï‡∏£.‡∏°‡∏°.**")
        print(f"üîπ ‡∏Ñ‡πà‡∏≤‡∏ó‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢: **{cable_ampacity} ‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå**")
        print(f"üîπ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏á‡∏à‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°: ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ **{num_circuits} ‡∏ß‡∏á‡∏à‡∏£**")
        print(f"üîπ ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ö‡∏£‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå (MCB) ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: **{breaker_rating:.0f} ‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå** ‡∏ï‡πà‡∏≠‡∏ß‡∏á‡∏à‡∏£")
    else:
        print("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤")
    print("---------------------------------------")

if __name__ == "__main__":
    calculate_cable_size()